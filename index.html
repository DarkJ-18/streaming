<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexo Digital | Cat치logo & Pedidos</title>
    <!-- Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts para tipograf칤a moderna -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Plus+Jakarta+Sans:wght@500;700&display=swap" rel="stylesheet">
    <style>
        /* ========================================
        ARQUITECTURA CSS: GLASSMORPHISM & NEON GLOW (V3.0)
        ========================================
        */
        :root {
            /* Paleta Premium Oscura */
            --bg-base: #030409;
            --bg-glass: rgba(15, 17, 26, 0.5);
            --bg-glass-hover: rgba(25, 28, 41, 0.7);
            
            /* Colores de Acento */
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --accent-primary: #3b82f6; 
            --accent-secondary: #8b5cf6; 
            --accent-success: #10b981;
            --accent-warning: #f59e0b;
            --accent-danger: #ef4444;
            --accent-gold: #f59e0b; 
            
            /* Bordes y Sombras */
            --border-glass: 1px solid rgba(255, 255, 255, 0.08);
            --border-glass-light: 1px solid rgba(255, 255, 255, 0.15);
            --shadow-glass: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            
            --space-s: clamp(0.75rem, 0.5rem + 0.5vw, 1rem);
            --space-m: clamp(1.5rem, 1rem + 1vw, 2.5rem);
            
            --font-main: 'Outfit', sans-serif;
            --font-display: 'Plus Jakarta Sans', sans-serif;
            
            --radius-std: 1rem; /* Bordes m치s redondeados */
            --radius-pill: 50px;
        }

        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            background-color: var(--bg-base);
            /* Fondo con mallas de luz (Mesh Gradient) */
            background-image: 
                radial-gradient(circle at 15% 0%, rgba(59, 130, 246, 0.15) 0%, transparent 40%),
                radial-gradient(circle at 85% 30%, rgba(139, 92, 246, 0.15) 0%, transparent 40%),
                radial-gradient(circle at 50% 100%, rgba(16, 185, 129, 0.05) 0%, transparent 50%);
            background-attachment: fixed;
            color: var(--text-primary);
            font-family: var(--font-main);
            font-size: 16px;
            line-height: 1.6;
            padding-bottom: 120px;
            overflow-x: hidden;
        }

        .layout-container {
            max-width: 1300px;
            margin: 0 auto;
            padding: var(--space-m);
            position: relative;
            z-index: 1;
        }

        header {
            text-align: center;
            padding-bottom: 2rem;
            margin-bottom: 3rem;
            position: relative;
        }

        header::after {
            content: '';
            position: absolute;
            bottom: 0; left: 50%;
            transform: translateX(-50%);
            width: 150px;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--accent-primary), var(--accent-purple), transparent);
        }

        h1 {
            font-family: var(--font-display);
            font-size: clamp(2.5rem, 5vw, 4rem);
            font-weight: 800;
            letter-spacing: -0.02em;
            background: linear-gradient(135deg, #ffffff 0%, #a5b4fc 100%);
            -webkit-background-clip: text;
            color: transparent;
            margin-bottom: 0.5rem;
            text-shadow: 0 0 40px rgba(139, 92, 246, 0.3);
        }

        header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            font-weight: 300;
        }

        /* CONTROL GLOBAL DE MONEDA (Estilo iOS Switch) */
        .currency-control {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-top: 2rem;
            background: rgba(0,0,0,0.4);
            padding: 0.35rem;
            border-radius: var(--radius-pill);
            border: var(--border-glass);
            backdrop-filter: blur(10px);
        }

        .currency-btn {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            padding: 0.6rem 1.5rem;
            border-radius: var(--radius-pill);
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
            font-family: var(--font-main);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .currency-btn:hover:not(.active) {
            color: white;
            background: rgba(255,255,255,0.05);
        }

        .currency-btn.active {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-purple));
            color: white;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        }

        /* T칈TULOS DE SECCI칍N */
        .section-title {
            grid-column: 1 / -1;
            color: white;
            font-family: var(--font-display);
            font-size: 1.5rem;
            font-weight: 700;
            margin-top: 2rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .section-title::after {
            content: '';
            flex-grow: 1;
            height: 1px;
            background: linear-gradient(90deg, rgba(255,255,255,0.1), transparent);
        }

        /* GRID SYSTEM */
        .grid-matrix {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(clamp(280px, 20vw, 320px), 1fr));
            gap: 1.5rem;
            margin-bottom: 4rem;
        }

        /* TARJETAS PREMIUM GLASSMORPHISM */
        .card-product {
            background: var(--bg-glass);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: var(--border-glass);
            border-radius: var(--radius-std);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            position: relative;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: var(--shadow-glass);
            overflow: hidden;
        }
        
        /* Brillo sutil superior en la tarjeta */
        .card-product::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .card-product:hover {
            transform: translateY(-8px);
            background: var(--bg-glass-hover);
            border-color: rgba(59, 130, 246, 0.4);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5), 0 0 20px rgba(59, 130, 246, 0.15);
        }
        
        .card-product:hover::before { opacity: 1; }

        .card-product.iptv-card:hover {
            border-color: rgba(139, 92, 246, 0.5);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5), 0 0 20px rgba(139, 92, 246, 0.2);
        }

        /* TARJETA ESTRELLA (Gold) */
        .card-product.featured-card {
            background: linear-gradient(145deg, rgba(30, 25, 10, 0.6), rgba(15, 17, 26, 0.8));
            border: 1px solid rgba(245, 158, 11, 0.3);
        }
        
        .card-product.featured-card::before { background: linear-gradient(90deg, transparent, var(--accent-gold), transparent); opacity: 0.5; }
        
        .card-product.featured-card:hover {
            border-color: var(--accent-gold);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.6), 0 0 30px rgba(245, 158, 11, 0.2);
            transform: translateY(-10px) scale(1.02);
        }

        .card-header {
            margin-bottom: 1.5rem;
            position: relative;
        }

        .product-title { 
            font-family: var(--font-display);
            font-weight: 700; 
            color: white; 
            font-size: 1.25rem;
            line-height: 1.2; 
        }
        
        .product-subtitle { 
            font-size: 0.85em; 
            color: var(--text-secondary); 
            display: block; 
            margin-top: 0.3rem; 
            font-weight: 300;
        }
        
        .product-price {
            font-family: var(--font-display);
            color: var(--text-primary);
            font-weight: 800;
            font-size: 1.8rem;
            margin-top: 0.5rem;
            letter-spacing: -0.03em;
        }
        
        .featured-card .product-price {
            background: linear-gradient(to right, #fcd34d, #f59e0b);
            -webkit-background-clip: text;
            color: transparent;
        }

        /* BADGES (Etiquetas) */
        .badge {
            font-size: 0.7rem;
            padding: 0.25em 0.6em;
            border-radius: 6px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 600;
            margin-left: 0.5em;
            vertical-align: middle;
        }
        
        .badge-iptv { background: rgba(139, 92, 246, 0.1); border-color: rgba(139, 92, 246, 0.3); color: #c4b5fd; }
        
        .badge-star { 
            background: linear-gradient(to right, #f59e0b, #fbbf24); 
            color: #000; 
            border: none;
            margin-bottom: 0.75rem; 
            display: inline-block; 
            margin-left: 0;
            box-shadow: 0 2px 10px rgba(245, 158, 11, 0.3);
        }

        /* NOTAS DE DISPONIBILIDAD */
        .product-note {
            font-size: 0.8rem;
            color: #cbd5e1;
            margin-top: 1rem;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            background: rgba(0,0,0,0.2);
            padding: 0.75rem;
            border-radius: 8px;
            border-left: 3px solid var(--accent-warning);
        }
        
        .product-note.promo {
            border-left-color: var(--accent-success);
        }

        /* BOT칍N AGREGAR PREMIUM */
        .btn-add-cart {
            margin-top: 1.5rem;
            width: 100%;
            padding: 0.85rem;
            background: rgba(255,255,255,0.03);
            border: var(--border-glass-light);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-family: var(--font-main);
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            overflow: hidden;
            position: relative;
        }

        .btn-add-cart::after {
            content: '';
            position: absolute;
            top: 0; left: -100%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s ease;
        }

        .card-product:hover .btn-add-cart {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }
        
        .card-product.iptv-card:hover .btn-add-cart {
            background: var(--accent-purple);
            border-color: var(--accent-purple);
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
        }
        
        .card-product.featured-card:hover .btn-add-cart {
            background: linear-gradient(to right, #d97706, #f59e0b);
            border-color: transparent;
            color: #000;
            box-shadow: 0 4px 15px rgba(245, 158, 11, 0.4);
        }

        .btn-add-cart:hover::after { left: 100%; }

        /* ========================================
           COMBO BUILDER V2 (Dashboard Style)
           ======================================== */
        .combo-builder {
            grid-column: 1 / -1;
            background: rgba(15, 17, 26, 0.4);
            backdrop-filter: blur(20px);
            border: var(--border-glass);
            border-radius: 1.5rem;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .combo-controls {
            padding: 2.5rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2.5rem;
        }

        .combo-step-label {
            display: block; 
            margin-bottom: 1rem; 
            color: var(--text-secondary); 
            font-size: 0.85em; 
            text-transform: uppercase; 
            letter-spacing: 0.1em;
            font-weight: 600;
        }

        /* Selector de Tipo (Pills) */
        .combo-base-selector {
            display: flex;
            gap: 0.75rem;
            overflow-x: auto;
            padding-bottom: 1rem;
            /* Ocultar scrollbar */
            scrollbar-width: none; 
        }
        .combo-base-selector::-webkit-scrollbar { display: none; }

        .selector-btn {
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.05);
            color: var(--text-secondary);
            padding: 1rem 1.5rem;
            border-radius: 12px;
            cursor: pointer;
            white-space: nowrap;
            font-family: var(--font-main);
            font-weight: 600;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .selector-btn:hover { background: rgba(255,255,255,0.05); color: white; }

        .selector-btn.active {
            background: rgba(59, 130, 246, 0.15);
            color: #60a5fa;
            border-color: rgba(59, 130, 246, 0.5);
            box-shadow: inset 0 0 20px rgba(59, 130, 246, 0.1);
        }

        .input-hidden { position: absolute; opacity: 0; width: 0; height: 0; }

        /* Tiers (Tama침o) */
        .tier-list { display: flex; flex-direction: column; gap: 0.75rem; }

        .tier-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.25rem;
            border: 1px solid rgba(255,255,255,0.05);
            border-radius: 12px;
            background: rgba(0,0,0,0.2);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .tier-row:hover { background: rgba(255,255,255,0.03); }

        .input-hidden:checked + .tier-row {
            background: linear-gradient(90deg, rgba(16, 185, 129, 0.1), transparent);
            border-color: var(--accent-success);
            color: white;
            box-shadow: inset 4px 0 0 var(--accent-success);
        }

        /* Checkboxes (Plataformas) */
        .platform-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            gap: 0.75rem;
        }

        .check-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0.85rem 1rem;
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.05);
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            height: 100%;
            user-select: none;
            color: var(--text-secondary);
        }

        .check-btn:hover { background: rgba(255,255,255,0.05); color: white; }

        .input-hidden:checked + .check-btn {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: white;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
            transform: scale(0.98);
        }

        .input-hidden:disabled + .check-btn {
            opacity: 0.3;
            cursor: not-allowed;
            background: transparent;
            border-color: rgba(255,255,255,0.02);
        }

        /* Resultado Combo */
        .result-bar {
            background: rgba(0,0,0,0.6);
            padding: 1.5rem 2.5rem;
            border-top: var(--border-glass);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1.5rem;
        }

        .btn-combo-add {
            background: linear-gradient(135deg, var(--accent-success), #059669);
            color: #000;
            border: none;
            padding: 1rem 2rem;
            border-radius: 8px;
            font-family: var(--font-display);
            font-weight: 800;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }
        
        .btn-combo-add:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.5); 
        }

        /* ============================
           CARRITO FLOTANTE Y SIDEBAR (Mejorados)
           ============================ */
        .cart-float-btn {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 65px;
            height: 65px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-purple));
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.4);
            z-index: 1000;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .cart-float-btn:hover { transform: scale(1.1) rotate(-5deg); }

        .cart-badge {
            position: absolute;
            top: -2px;
            right: -2px;
            background: var(--accent-danger);
            color: white;
            font-family: var(--font-display);
            font-size: 0.8rem;
            font-weight: 800;
            width: 26px;
            height: 26px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid var(--bg-void);
            box-shadow: 0 2px 5px rgba(0,0,0,0.5);
        }

        .cart-sidebar {
            position: fixed;
            top: 0; right: -450px;
            width: 100%; max-width: 450px;
            height: 100vh;
            background: rgba(10, 11, 16, 0.85);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border-left: 1px solid rgba(255,255,255,0.05);
            z-index: 1001;
            transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            box-shadow: -15px 0 40px rgba(0,0,0,0.5);
        }

        .cart-sidebar.open { right: 0; }

        .cart-header {
            padding: 1.5rem 2rem;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-header h3 { font-family: var(--font-display); font-size: 1.3rem; }

        .cart-close {
            background: rgba(255,255,255,0.05);
            border: none;
            color: white;
            width: 36px; height: 36px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            transition: background 0.2s;
        }
        
        .cart-close:hover { background: rgba(255,255,255,0.1); }

        .cart-items {
            flex-grow: 1;
            overflow-y: auto;
            padding: 1.5rem 2rem;
        }

        .cart-item {
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            animation: fadeIn 0.3s ease;
        }

        .item-info { flex-grow: 1; margin-right: 1rem; }
        .item-name { font-weight: 700; color: white; display: block; font-size: 0.95em; }
        .item-meta { font-size: 0.8em; color: var(--text-secondary); display: block; margin-top: 0.2rem;}
        .item-price { font-family: var(--font-display); color: var(--accent-success); font-weight: 800; }
        
        .btn-remove {
            background: rgba(239, 68, 68, 0.1);
            border: none;
            color: var(--accent-danger);
            border-radius: 6px;
            width: 30px; height: 30px;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 0.5rem;
        }
        .btn-remove:hover { background: var(--accent-danger); color: white; }

        .cart-footer {
            padding: 1.5rem 2rem;
            border-top: 1px solid rgba(255,255,255,0.05);
            background: rgba(0,0,0,0.5);
        }

        .cart-total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            font-size: 1.2em;
            font-family: var(--font-display);
            font-weight: 800;
            color: white;
        }

        .btn-checkout {
            width: 100%;
            padding: 1.2rem;
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
            border: none;
            border-radius: 12px;
            font-family: var(--font-display);
            font-weight: 800;
            font-size: 1.1rem;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.75rem;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3);
        }

        .btn-checkout:hover { 
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(37, 211, 102, 0.4);
        }

        .overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6);
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s;
            backdrop-filter: blur(4px);
        }
        .overlay.open { opacity: 1; pointer-events: all; }

        /* ============================
           TOAST NOTIFICATIONS (Minimal)
           ============================ */
        .toast-container {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            z-index: 2000;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            pointer-events: none;
        }

        .toast {
            background: rgba(15, 17, 26, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            min-width: max-content;
            font-weight: 600;
            animation: toastSlideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .toast i { font-size: 1.2rem; }
        .toast.success i { color: var(--accent-success); }
        .toast.error i { color: var(--accent-danger); }

        @keyframes toastSlideUp {
            from { opacity: 0; transform: translateY(20px) scale(0.9); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        @keyframes toastFadeOut {
            to { opacity: 0; transform: translateY(-20px) scale(0.9); }
        }

    </style>
</head>
<body>

    <main class="layout-container">
        <header>
            <h1>Nexo Digital</h1>
            <p>Tu entretenimiento sin l칤mites, con garant칤a total.</p>
            
            <!-- SELECTOR GLOBAL DE MONEDA -->
            <div class="currency-control">
                <button class="currency-btn active" id="btn-cop" onclick="setCurrency('COP')">
                    <i class="fas fa-coins"></i> Comprar en COP
                </button>
                <button class="currency-btn" id="btn-usd" onclick="setCurrency('USD')">
                    <i class="fas fa-dollar-sign"></i> Comprar en USD
                </button>
            </div>
        </header>

        <!-- 1. INVENTARIO PREMIUM -->
        <h2 class="section-title"><i class="fas fa-crown"></i> Plataformas Premium</h2>
        <section class="grid-matrix" id="premium-grid"></section>

        <!-- 2. INVENTARIO EST츼NDAR -->
        <h2 class="section-title"><i class="fas fa-play-circle"></i> Plataformas Est치ndar</h2>
        <section class="grid-matrix" id="standard-grid"></section>
        
        <!-- 3. SECCI칍N IPTV -->
        <h2 class="section-title" style="color: var(--accent-purple); margin-top: 3rem;"><i class="fas fa-tv"></i> Televisi칩n Digital (IPTV)</h2>
        <section class="grid-matrix" id="iptv-grid"></section>

        <!-- 4. HERRAMIENTAS -->
        <h2 class="section-title" style="margin-top: 3rem;"><i class="fas fa-bolt"></i> Edici칩n, M칰sica & AI</h2>
        <section class="grid-matrix" id="tools-grid"></section>

        <!-- 5. MOTOR DE COMBOS -->
        <h2 class="section-title" style="margin-top: 3rem;"><i class="fas fa-layer-group"></i> Arma tu Combo</h2>
        <article class="combo-builder">
            <div class="combo-controls">
                
                <!-- A. SELECCI칍N DE BASE -->
                <div style="grid-column: 1 / -1;">
                    <span class="combo-step-label">1. Selecciona la Base del Combo</span>
                    <div class="combo-base-selector" id="base-selector"></div>
                </div>

                <!-- B. SELECCI칍N DE TAMA칌O -->
                <div>
                    <span class="combo-step-label">2. Elige el Tama침o</span>
                    <div id="size-options" class="tier-list"></div>
                </div>

                <!-- C. SELECCI칍N DE ADICIONALES -->
                <div>
                    <span class="combo-step-label">3. Selecciona tus Apps Adicionales (<span id="count-current">0</span>/<span id="count-max">--</span>)</span>
                    <div id="platform-options" class="platform-grid"></div>
                    <p style="font-size:0.8em; color:var(--text-secondary); margin-top:1rem; line-height:1.4;" id="combo-note"></p>
                </div>
            </div>

            <div class="result-bar">
                <div>
                    <div style="font-size:0.85em; color:var(--text-secondary); text-transform:uppercase; letter-spacing:0.05em;">Este combo incluye:</div>
                    <div id="base-includes" style="color:white; font-weight:700; font-size:1.1em; margin-top:0.2rem;">--</div>
                </div>
                <div style="display:flex; align-items:center; gap:2rem;">
                    <div class="product-price" id="total-price" style="margin:0; font-size:2rem;">$0 COP</div>
                    <button class="btn-combo-add" id="btn-add-combo" onclick="addComboToCart()">
                        <i class="fas fa-cart-plus"></i> Agregar
                    </button>
                </div>
            </div>
        </article>

    </main>

    <!-- UI DEL CARRITO -->
    <button class="cart-float-btn" onclick="toggleCart()">
        <i class="fas fa-shopping-bag"></i>
        <div class="cart-badge" id="cart-count">0</div>
    </button>

    <div class="overlay" id="cart-overlay" onclick="toggleCart()"></div>

    <aside class="cart-sidebar" id="cart-sidebar">
        <div class="cart-header">
            <h3><i class="fas fa-shopping-bag"></i> Tu Pedido</h3>
            <button class="cart-close" onclick="toggleCart()"><i class="fas fa-times"></i></button>
        </div>
        <div class="cart-items" id="cart-items-container">
            <div style="text-align:center; color:var(--text-secondary); margin-top:3rem; display:flex; flex-direction:column; gap:1rem; align-items:center;">
                <i class="fas fa-box-open" style="font-size:3rem; opacity:0.2;"></i>
                Tu carrito est치 vac칤o.
            </div>
        </div>
        <div class="cart-footer">
            <div class="cart-total-row">
                <span>Total Sugerido:</span>
                <span id="cart-total-display">$0</span>
            </div>
            <button class="btn-checkout" onclick="checkoutWhatsApp()">
                <i class="fab fa-whatsapp" style="font-size:1.3em;"></i> Procesar Pedido
            </button>
        </div>
    </aside>

    <!-- CONTENEDOR DE NOTIFICACIONES -->
    <div class="toast-container" id="toast-container"></div>

    <script>
        // --- CONSTANTES FINANCIERAS ---
        let tasaDolarActual = 4000; 
        const FACTOR_USD = 1.30;    
        
        const FORMATTER_COP = new Intl.NumberFormat('es-CO', { style: 'currency', currency: 'COP', maximumFractionDigits: 0 });
        const FORMATTER_USD = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 2 });
        
        let currentCurrency = 'COP';
        let cart = [];
        let currentComboPrice = 0;

        /* * INVENTARIO BASE */
        const INVENTORY = {
            premium: [
                { id: "nfx", name: "Netflix Premium 4K", sub: "Cuenta Original", price: 15000, priceUsd: 9.00 },
                { id: "dsp", name: "Disney Premium", sub: "Incluye ESPN", price: 16000, priceUsd: 10.00, note: "Sujeto a disponibilidad" },
                { id: "max", name: "Max", sub: "Cuenta Original", price: 14000, priceUsd: 8.00 },
                { id: "amz", name: "Amazon Prime Video", sub: "Sin Publicidad", price: 15000, priceUsd: 9.00 },
                { id: "uni", name: "Universal+", sub: "Series NBC", price: 14000, priceUsd: 8.00 }
            ],
            standard: [
                { id: "cru", name: "CrunchyRoll", sub: "Fan", price: 14000, priceUsd: 8.00 },
                { id: "par", name: "Paramount+", sub: "Standard", price: 14000, priceUsd: 8.00 },
                { id: "plx", name: "Plex", sub: "Activaci칩n", price: 15000, priceUsd: 9.00 },
                { id: "dss", name: "Disney Standard", sub: "B치sico", price: 12000, priceUsd: 7.00 },
                { id: "vix", name: "ViX Premium", sub: "Deportes", price: 12000, priceUsd: 7.00 }
            ],
            iptv: [
                { id: "ip1m1", name: "IPTV 1 Mes", sub: "1 Pantalla", price: 13000, priceUsd: 6.00, note: "Pide tu prueba gratis", promo: true },
                { id: "ip1m4", name: "IPTV 1 Mes", sub: "4 Dispositivos", price: 18000, priceUsd: 10.00 },
                { id: "ip2m4", name: "IPTV 2 Meses", sub: "4 Dispositivos", price: 35000, priceUsd: 16.00 },
                { id: "ip3m4", name: "Pack Trimestral (3x2)", sub: "4 Disp (Pague 2 Lleve 3)", price: 50000, priceUsd: 22.00, featured: true },
                { id: "ip6m4", name: "IPTV 6 Meses", sub: "4 Dispositivos", price: 90000, priceUsd: 40.00 },
                { id: "ip1y4", name: "IPTV 1 A침o", sub: "4 Dispositivos", price: 165000, priceUsd: 70.00 },
                { id: "mega", name: "Mega TV", sub: "1 Mes", price: 27000, priceUsd: 12.00, localOnly: true, note: "Consultar disponibilidad" },
                { id: "jelly", name: "Jellyfin", sub: "1 Mes", price: 22000, priceUsd: 10.00, localOnly: true, note: "Consultar disponibilidad" }
            ],
            tools: [
                { id: "cap", name: "CapCut Pro PC/Mobile", sub: "1 Mes", price: 26000, priceUsd: 10.00, featured: true },
                { id: "yt1", name: "YouTube Premium", sub: "1 Mes", price: 16000, priceUsd: 9.00 },
                { id: "yt3", name: "YouTube Premium", sub: "3 Meses", price: 39000, priceUsd: 20.00, note: "Entrega mes a mes" },
                { id: "spo", name: "Spotify Premium", sub: "3 Meses", price: 39000, priceUsd: 20.00, note: "Sujeto a disponibilidad" },
                { id: "gpt", name: "ChatGPT Plus", sub: "Cuenta Personal", price: 28000, priceUsd: 15.00 },
                { id: "cnv", name: "Canva Pro", sub: "1 A침o", price: 110000, priceUsd: 35.00, note: "Activaci칩n en tu propio correo" }
            ]
        };

        const COMBO_SYSTEM = {
            "god_tier": {
                label: "PACK SUPREMO (NFLX + DISNEY)",
                includes: "Netflix 4K + Disney Premium",
                note: "游눠 Selecciona adicionales distintos.",
                options: ["Max", "Amazon Prime", "Universal+", "IPTV", "ViX", "Plex", "CrunchyRoll", "Paramount"],
                tiers: [ 
                    { k: 2, label: "Solo Base", retail: 30000, retailUsd: 20.00 },
                    { k: 3, label: "Tripleta (+1 Adicional)", retail: 37000, retailUsd: 25.00 },
                    { k: 4, label: "Cuadrupleta (+2 Adicionales)", retail: 46000, retailUsd: 30.00 },
                    { k: 5, label: "Quintupla (+3 Adicionales)", retail: 53000, retailUsd: 35.00 }
                ]
            },
            "netflix_4k": {
                label: "COMBO NETFLIX 4K",
                includes: "Netflix 4K",
                note: "游눠 Incluye Netflix. Agrega otras apps.",
                options: ["Max", "Amazon Prime", "Disney Standard", "Universal+", "IPTV", "ViX", "Plex", "CrunchyRoll", "Paramount"],
                tiers: [ 
                    { k: 2, label: "Dupla (+1 Adicional)", retail: 26000, retailUsd: 16.00 },
                    { k: 3, label: "Tripleta (+2 Adicionales)", retail: 33000, retailUsd: 22.00 },
                    { k: 4, label: "Cuadrupleta (+3 Adicionales)", retail: 40000, retailUsd: 28.00 },
                    { k: 5, label: "Quintupla (+4 Adicionales)", retail: 47000, retailUsd: 32.00 }
                ]
            },
            "disney_prem": {
                label: "COMBO DISNEY PREMIUM",
                includes: "Disney Premium (ESPN)",
                note: "游눠 Incluye Disney+. Agrega otras apps.",
                options: ["Max", "Amazon Prime", "Universal+", "IPTV", "ViX", "Plex", "CrunchyRoll", "Paramount"],
                tiers: [ 
                    { k: 2, label: "Dupla (+1 Adicional)", retail: 25000, retailUsd: 15.00 },
                    { k: 3, label: "Tripleta (+2 Adicionales)", retail: 31000, retailUsd: 20.00 },
                    { k: 4, label: "Cuadrupleta (+3 Adicionales)", retail: 37000, retailUsd: 25.00 },
                    { k: 5, label: "Quintupla (+4 Adicionales)", retail: 45000, retailUsd: 30.00 }
                ]
            },
            "flex_mix": {
                label: "COMBOS VARIOS",
                includes: "Selecci칩n Libre",
                note: "游눠 Elige plataformas distintas para aplicar el descuento.",
                options: ["Max", "Amazon Prime", "Disney Standard", "Universal+", "IPTV", "ViX", "Plex", "CrunchyRoll", "Paramount"],
                tiers: [ 
                    { k: 2, label: "Dupla (2 Pantallas)", retail: 19000, retailUsd: 12.00 },
                    { k: 3, label: "Tripleta (3 Pantallas)", retail: 25000, retailUsd: 16.00 },
                    { k: 4, label: "Cuadrupleta (4 Pantallas)", retail: 29000, retailUsd: 20.00 },
                    { k: 5, label: "Quintupla (5 Pantallas)", retail: 33000, retailUsd: 24.00 }
                ]
            }
        };

        // --- SISTEMA DE TOASTS ---
        function showToast(message, type = 'success') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            
            let iconClass = 'fa-check-circle';
            if(type === 'error') iconClass = 'fa-exclamation-circle';
            if(type === 'info') iconClass = 'fa-info-circle';

            toast.className = `toast ${type}`;
            toast.innerHTML = `<i class="fas ${iconClass}"></i> <span>${message}</span>`;
            container.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'toastFadeOut 0.3s forwards';
                toast.addEventListener('animationend', () => toast.remove());
            }, 3000);
        }

        // --- API DE DIVISAS ---
        async function cargarTasaDolar() {
            try {
                const respuesta = await fetch('https://open.er-api.com/v6/latest/USD');
                if (respuesta.ok) {
                    const datos = await respuesta.json();
                    tasaDolarActual = datos.rates.COP;
                }
            } catch (error) {
                console.warn("API de divisas fall칩. Usando tasa base de $4000.");
            }
        }

        // --- CAMBIO DE MONEDA GLOBAL ---
        function setCurrency(currency) {
            if (cart.length > 0 && cart[0].currency !== currency) {
                cart = []; 
                updateCartUI();
                showToast("Carrito reiniciado por cambio de moneda", "info");
            }

            currentCurrency = currency;
            
            document.getElementById('btn-cop').classList.toggle('active', currency === 'COP');
            document.getElementById('btn-usd').classList.toggle('active', currency === 'USD');
            
            renderAllGrids();
        }

        function renderAllGrids() {
            renderGrid('premium-grid', INVENTORY.premium);
            renderGrid('standard-grid', INVENTORY.standard);
            renderGrid('iptv-grid', INVENTORY.iptv, 'iptv');
            renderGrid('tools-grid', INVENTORY.tools);
            calcCombo(); 
        }

        // --- RENDERIZADO DE TARJETAS (H칤brido) ---
        function renderGrid(id, data, style = 'normal') {
            const el = document.getElementById(id);
            if(!el) return;

            const filteredData = data.filter(item => {
                if (currentCurrency === 'USD' && item.localOnly) return false;
                return true;
            });

            el.innerHTML = filteredData.map(item => {
                let displayPrice, displayFormatter;
                
                if (currentCurrency === 'USD') {
                    let dynUsd = Math.ceil((item.price / tasaDolarActual) * FACTOR_USD);
                    displayPrice = item.priceUsd ? Math.max(item.priceUsd, dynUsd) : dynUsd;
                    displayFormatter = FORMATTER_USD;
                } else {
                    displayPrice = item.price;
                    displayFormatter = FORMATTER_COP;
                }

                const itemPayload = JSON.stringify({
                    name: item.name,
                    sub: item.sub,
                    price: displayPrice,
                    currency: currentCurrency
                }).replace(/"/g, "&quot;");

                let badgeHtml = item.featured ? '<span class="badge badge-star"><i class="fas fa-bolt"></i> ESTRELLA</span>' : '';
                
                let noteHtml = '';
                if(item.note) {
                    const noteClass = item.promo ? 'product-note promo' : 'product-note';
                    const icon = item.promo ? 'fa-check' : 'fa-info-circle';
                    noteHtml = `<div class="${noteClass}"><i class="fas ${icon}" style="margin-top:2px;"></i> <span>${item.note}</span></div>`;
                }

                return `
                <article class="card-product ${style === 'iptv' ? 'iptv-card' : ''} ${item.featured ? 'featured-card' : ''}">
                    <div class="card-header">
                        ${badgeHtml}
                        <div class="product-title">${item.name}</div>
                        <span class="product-subtitle">${item.sub}</span>
                    </div>
                    <div style="margin-top:auto;">
                        <div class="product-price">${displayFormatter.format(displayPrice)}</div>
                        ${noteHtml}
                        <button class="btn-add-cart" onclick="addToCart(${itemPayload})">
                            <i class="fas fa-plus"></i> Agregar
                        </button>
                    </div>
                </article>`;
            }).join('');
        }

        // --- L칍GICA DEL CARRITO ---
        function toggleCart() {
            document.getElementById('cart-sidebar').classList.toggle('open');
            document.getElementById('cart-overlay').classList.toggle('open');
        }

        function addToCart(item) {
            try {
                if (cart.length > 0 && cart[0].currency !== item.currency) {
                    showToast(`Por favor finaliza tu pedido actual en ${cart[0].currency} primero.`, 'error');
                    return;
                }

                const cartItem = {
                    id: Date.now(),
                    name: item.name,
                    details: item.sub || '',
                    price: item.price,
                    currency: item.currency || 'COP'
                };
                
                cart.push(cartItem);
                updateCartUI();
                showToast(`${item.name} agregado`, 'success');
            } catch (error) {
                console.error(error);
            }
        }

        function addComboToCart() {
            try {
                if (cart.length > 0 && cart[0].currency !== currentCurrency) {
                    showToast(`Por favor vac칤a tu carrito actual primero.`, 'error');
                    return;
                }

                const config = COMBO_SYSTEM[currentComboKey];
                const tierInput = document.querySelector('input[name="tier"]:checked');
                
                if(!tierInput) {
                    showToast("Selecciona un tama침o para el combo.", "warning");
                    return;
                }
                
                const tier = config.tiers[tierInput.value];
                const checkboxes = document.querySelectorAll('input[name="opt"]:checked');
                const selectedOpts = Array.from(checkboxes).map(cb => cb.value);
                
                const cartItem = {
                    id: Date.now(),
                    name: config.label,
                    details: `${tier.label} [${selectedOpts.join(', ')}]`,
                    price: currentComboPrice,
                    currency: currentCurrency
                };

                cart.push(cartItem);
                updateCartUI();
                showToast(`Combo agregado correctamente`, 'success');
            } catch (error) {
                console.error(error);
            }
        }

        function removeFromCart(id) {
            cart = cart.filter(item => item.id !== id);
            updateCartUI();
        }

        function updateCartUI() {
            document.getElementById('cart-count').textContent = cart.length;
            const container = document.getElementById('cart-items-container');
            
            if (cart.length === 0) {
                container.innerHTML = `
                    <div style="text-align:center; color:var(--text-secondary); margin-top:3rem; display:flex; flex-direction:column; gap:1rem; align-items:center;">
                        <i class="fas fa-box-open" style="font-size:3rem; opacity:0.2;"></i>
                        Tu carrito est치 vac칤o.
                    </div>`;
                document.getElementById('cart-total-display').textContent = '$0';
                return;
            }

            let html = '';
            let total = 0;
            let currency = cart[0].currency;

            cart.forEach(item => {
                total += item.price;
                const formatter = currency === 'USD' ? FORMATTER_USD : FORMATTER_COP;
                html += `
                <div class="cart-item">
                    <div class="item-info">
                        <span class="item-name">${item.name}</span>
                        <span class="item-meta">${item.details}</span>
                    </div>
                    <div style="text-align:right;">
                        <div class="item-price">${formatter.format(item.price)}</div>
                        <button class="btn-remove" onclick="removeFromCart(${item.id})">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                </div>`;
            });

            container.innerHTML = html;
            const formatter = currency === 'USD' ? FORMATTER_USD : FORMATTER_COP;
            document.getElementById('cart-total-display').textContent = formatter.format(total);
        }

        function checkoutWhatsApp() {
            if (cart.length === 0) {
                showToast("El carrito est치 vac칤o", "warning");
                return;
            }

            try {
                let totalValue = 0;
                cart.forEach(item => totalValue += item.price);
                const currency = cart[0].currency;
                const formatter = currency === 'USD' ? FORMATTER_USD : FORMATTER_COP;

                let rawMessage = "*NUEVA SOLICITUD DE PEDIDO*\n";
                rawMessage += "-----------------------------------\n";
                
                cart.forEach((item, index) => {
                    rawMessage += `*${index + 1}. ${item.name}*\n`;
                    rawMessage += `   Precio Lista: ${formatter.format(item.price)}\n`;
                    if(item.details) rawMessage += `   Detalles: _${item.details}_\n`;
                    rawMessage += `\n`;
                });

                rawMessage += "-----------------------------------\n";
                rawMessage += `*TOTAL A PAGAR (Sugerido): ${formatter.format(totalValue)}*\n\n`;
                
                // CODIFICACI칍N T츼CTICA
                const now = new Date();
                const timeCode = now.getHours().toString().padStart(2,'0') + now.getMinutes().toString().padStart(2,'0'); 
                
                let priceCode = '';
                let currencyCode = '';

                if (currency === 'COP') {
                    priceCode = Math.floor(totalValue / 1000).toString().padStart(3, '0');
                    currencyCode = 'C';
                } else {
                    priceCode = Math.floor(totalValue).toString().padStart(3, '0');
                    currencyCode = 'U';
                }

                const smartRef = `TX-${timeCode}-${priceCode}${currencyCode}`;
                
                rawMessage += `_Ref. Transacci칩n: ${smartRef}_`;

                const encodedPayload = encodeURIComponent(rawMessage);
                const TARGET_PHONE = "573132973032"; 
                
                window.open(`https://wa.me/${TARGET_PHONE}?text=${encodedPayload}`, '_blank', 'noopener,noreferrer');

                cart = [];
                updateCartUI();
                toggleCart();
                showToast("Procesando en WhatsApp...", "info");
                
            } catch (error) {
                console.error(error);
                showToast("Error al generar el pedido", "error");
            }
        }

        // --- L칍GICA DE COMBOS ---
        let currentComboKey = "god_tier";
        
        function initCombos() {
            const selectorContainer = document.getElementById('base-selector');
            Object.keys(COMBO_SYSTEM).forEach(key => {
                const btn = document.createElement('button');
                btn.className = `selector-btn ${key === currentComboKey ? 'active' : ''}`;
                btn.textContent = COMBO_SYSTEM[key].label;
                btn.onclick = () => switchComboBase(key);
                selectorContainer.appendChild(btn);
            });
            updateComboUI();
        }

        function switchComboBase(key) {
            currentComboKey = key;
            document.querySelectorAll('input[name="opt"]').forEach(cb => cb.checked = false);
            document.querySelectorAll('.selector-btn').forEach(btn => btn.classList.toggle('active', btn.textContent === COMBO_SYSTEM[key].label));
            updateComboUI();
        }

        function updateComboUI() {
            const config = COMBO_SYSTEM[currentComboKey];
            const sizeContainer = document.getElementById('size-options');
            const optContainer = document.getElementById('platform-options');
            const existingTier = document.querySelector('input[name="tier"]:checked');
            const selectedIdx = existingTier ? existingTier.value : 0;

            sizeContainer.innerHTML = config.tiers.map((tier, idx) => {
                let displayTierPrice;
                if (currentCurrency === 'USD') {
                    let dynUsd = Math.ceil((tier.retail / tasaDolarActual) * FACTOR_USD);
                    displayTierPrice = tier.retailUsd ? Math.max(tier.retailUsd, dynUsd) : dynUsd;
                } else {
                    displayTierPrice = tier.retail;
                }
                let formatter = currentCurrency === 'USD' ? FORMATTER_USD : FORMATTER_COP;
                
                return `
                <label>
                    <input type="radio" name="tier" value="${idx}" class="input-hidden" ${idx == selectedIdx ? 'checked' : ''} onchange="calcCombo()">
                    <div class="tier-row">
                        <span style="font-weight:600;">${tier.label}</span>
                        <span style="font-family:var(--font-display); font-weight:800; color:var(--accent-success);">${formatter.format(displayTierPrice)}</span>
                    </div>
                </label>`
            }).join('');

            const currentlyChecked = Array.from(document.querySelectorAll('input[name="opt"]:checked')).map(cb => cb.value);
            optContainer.innerHTML = config.options.map(opt => `
                <label>
                    <input type="checkbox" name="opt" value="${opt}" class="input-hidden" ${currentlyChecked.includes(opt) ? 'checked' : ''} onchange="calcCombo()">
                    <span class="check-btn">${opt}</span>
                </label>`).join('');

            document.getElementById('base-includes').textContent = config.includes;
            document.getElementById('combo-note').textContent = config.note;
            calcCombo();
        }

        function calcCombo() {
            const config = COMBO_SYSTEM[currentComboKey];
            const tierInput = document.querySelector('input[name="tier"]:checked');
            if(!tierInput) return;
            const tier = config.tiers[tierInput.value];
            let baseCount = 1;
            if (currentComboKey === 'god_tier') baseCount = 2;
            if (currentComboKey === 'flex_mix') baseCount = 0;
            const maxAdicionales = tier.k - baseCount;
            const checkboxes = document.querySelectorAll('input[name="opt"]');
            const checked = Array.from(checkboxes).filter(c => c.checked);
            
            document.getElementById('count-current').textContent = checked.length;
            document.getElementById('count-max').textContent = maxAdicionales;
            
            if (currentCurrency === 'USD') {
                let dynUsd = Math.ceil((tier.retail / tasaDolarActual) * FACTOR_USD);
                currentComboPrice = tier.retailUsd ? Math.max(tier.retailUsd, dynUsd) : dynUsd;
            } else {
                currentComboPrice = tier.retail;
            }

            let formatter = currentCurrency === 'USD' ? FORMATTER_USD : FORMATTER_COP;
            
            document.getElementById('total-price').textContent = formatter.format(currentComboPrice);
            
            checkboxes.forEach(cb => {
                if(!cb.checked) cb.disabled = checked.length >= maxAdicionales;
                else cb.disabled = false;
            });
        }

        // --- INIT ---
        window.addEventListener('DOMContentLoaded', async () => {
            try {
                await cargarTasaDolar();
                renderAllGrids();
                initCombos();
            } catch (e) {
                console.error(e);
                showToast("Cargando en modo offline", "info");
            }
        });

    </script>
</body>
</html>
